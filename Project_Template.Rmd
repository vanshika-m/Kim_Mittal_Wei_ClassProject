\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, include=FALSE}
# Set your working directory
getwd()
# Load your packages
library(tidyverse)
library(lubridate)
library(ggplot2)
library(raster)
library(here)
library(sf)
library(leaflet)
library(agricolae)
library(rvest)
library(vctrs)
library(mapview)

# Set your ggplot theme
mytheme<-theme_classic(base_size=13)+
theme(
legend.background = element_rect(color='grey',fill='beige'),
plot.title=element_text(color='black',size=15),
legend.position="right",
legend.text = element_text(size=11)
)

```

# Load your datasets
```{r}
#dataset on palm cultivation 
palm_production <-read.csv("./palm-oil-production.csv",stringsAsFactors = TRUE)
#filtering for only Indonesia and Malaysia, making a new column with an adjusted scale for oil palm cultivation 
palm_production <- palm_production %>%
  filter(Entity == "Indonesia"| Entity == "Malaysia", Year %in% (1990:2020))%>%
  mutate(Oil.Palm = Palm.oil...00000257....Production...005510....tonnes/1000) %>%
  select(Entity, Year, Oil.Palm)
  
#dataset on forest area 
forest_area <- read.csv("./forest-area-primary-planted.csv",stringsAsFactors = TRUE)
#filtering for Indonesia and Malaysia, adjusting scales for planted and natural forests
forest_area <- forest_area %>%
  filter(Entity == "Indonesia" | Entity == "Malaysia") %>%
  mutate(Planted.Forest = 
           Planted.Forest...00006716....Area...005110....hectares/1000000 ) %>%
  mutate(Natural.Forest = 
           Naturally.regenerating.forest...00006717....Area...005110....hectares/1000000)%>%
  select(Entity, Year, Planted.Forest, Natural.Forest)

#datasets on carbon emissions 
carbon_emissions <- read.csv("./ghg-emissions-by-sector_indonesia.csv", stringsAsFactors = TRUE)
carbon_emissions <- carbon_emissions %>%
  filter(Entity == "Indonesia"| Entity == "Malaysia")%>%
  select(Entity, Year, Greenhouse.gas.emissions.from.land.use.change.and.forestry)%>%
  rename(CO2.emissions = Greenhouse.gas.emissions.from.land.use.change.and.forestry)
```

```{r}
#Data set on global prices (extra)
global_price <-read.csv("./Global price of palm oil.csv",stringsAsFactors = TRUE)
global_price$DATE <- ymd(global_price$DATE)
global_price_graph <- ggplot(global_price, aes(x= DATE, y = PPOILUSDM))+
  geom_point()+
  geom_smooth(method = lm)+
   labs(x= "Years", y = "Global Price Levels", title = "Plam Oil Global Price Trends")
```

```{r}
#merge the datasets into one for analysis 
merged_dataset <- merge(palm_production, forest_area, by = c("Entity", "Year"), 
                 all = TRUE)
dataset <- merge(merged_dataset, carbon_emissions, by = c("Entity", "Year"), 
                 all = TRUE)
dataset <- dataset %>%
  mutate(Total.Forest = Planted.Forest + Natural.Forest)
```

# Rationale and Research Questions


\newpage

# Dataset Information



\newpage

# Exploratory Analysis 

```{r}
#plotting oil palm cultivation over the years to see the trend 
options(scipen = 999)
palm_production_graph <- ggplot(palm_production, aes(x=Year, y = Oil.Palm, color = Entity)) + 
  geom_point()+ 
  geom_smooth(method = lm)+ 
  labs(x= "Years", y = "Palm Oil Production ()", title = "Palm Production in Indonesia and Malaysia over the years")
  
#graphing the data on forest area 
forest_area_graph <- ggplot(forest_area, aes(x=Year)) +
                     geom_line(aes( y = Planted.Forest), color = "green") + 
                     geom_line(aes(y = Natural.Forest, color = "red")) + 
                    facet_wrap(vars(Entity))
                    labs(x= "Years", y = "Forest Area ()", title = 
                           "Forest Area over the years")
                           
#graphing dataset on carbon emissions 
carbon_emissions_graph <- ggplot(carbon_emissions, aes(x=Year, y = CO2.emissions, color = Entity)) +
  geom_point()+ 
  geom_smooth(method = lm)+ 
  labs(x= "Years", y = "Carbon Dioxide Emissions (billion tonnes)", title = "Carbon Dioxide Emissions over the years")
```
\newpage

# Analysis
```{r, testing research question 1}
#MULTIPLE LINEAR REGRESSION
#checking best fit models through AIC 
natural_AIC <- lm(data = dataset, Natural.Forest ~ Year + Oil.Palm)
step(natural_AIC)

planted_AIC <- lm(data = dataset, Planted.Forest ~ Year + Oil.Palm)
step(planted_AIC)

total_AIC <- lm(data = dataset, Total.Forest ~ Year + Oil.Palm)
step(total_AIC)
#include both oil palm and year, they have the lowest AIC 

#Planted Forests in Indonesia 
planted_ind <- lm(data = filter(dataset, Entity == "Indonesia") , Planted.Forest ~ Oil.Palm + Year)
summary(planted_ind)

#Natural Forests in Indonesia 
natural_ind <- lm(data = filter(dataset, Entity == "Indonesia") , 
                  Total.Forest ~ Oil.Palm + Year)
summary(natural_ind)

#Total Forests in Indonesia
total_ind <- lm(data = filter(dataset, Entity == "Indonesia") ,
                  Total.Forest ~ Oil.Palm + Year)
summary(total_ind)

#Planted Forests in Malaysia
planted_mly <- lm(data = filter(dataset, Entity == "Malaysia") ,
                  Planted.Forest ~ Oil.Palm + Year)
summary(planted_mly)

#Natural Forests in Malaysia
natural_mly <- lm(data = filter(dataset, Entity == "Malaysia") , 
                  Natural.Forest ~ Oil.Palm + Year)
summary(natural_mly)

#Total Forests in Malaysia
total_mly <- lm(data = filter(dataset, Entity == "Malaysia") ,
                  Total.Forest ~ Oil.Palm + Year)
summary(total_mly)
```

```{r, testing reaseach question 2}
#checking best fit models through AIC 
co2_AIC <- lm(data = dataset, CO2.emissions ~ Year + Oil.Palm + Natural.Forest + Total.Forest + Planted.Forest)
step(co2_AIC) 
#model to be used is with year, oil palm and total forests - has the lowest AIC 

#MLR checking for CO2 in Indonesia 
CO2_ind <- lm(data = filter(dataset, Entity == "Indonesia") , 
                  CO2.emissions ~ Total.Forest + Oil.Palm + Year)
summary(CO2_ind)

#MLR checking for CO2 in Malaysia
CO2_mly <- lm(data = filter(dataset, Entity == "Malaysia") , 
                   CO2.emissions ~ Total.Forest + Oil.Palm + Year)
summary(CO2_mly)
```


```

```{r}
dataset_ind <- dataset %>%
  subset(Entity == "Indonesia") %>%
  mutate(Date = paste(Year, "-", 01, "-", 01))
dataset_ind$Date <- ymd(dataset_ind$Date)

#TIME SERIES ANALYSIS 
natural_forest_ts <- ts(dataset_ind$Natural.Forest, start = c(1990,01,01))
natural_forest_decomp <- stl(natural_forest_ts, s.window = "periodic")
plot(natural_forest_decomp)

natural_forest_decomp_test <- decompose(natural_forest_ts)
plot(natural_forest_decomp_test)
```


# Question 1: <insert specific question here and add additional subsections for additional questions below, if needed>

## Question 2: 




\newpage

# Summary and Conclusions


\newpage

# References
<add references here if relevant, otherwise delete this section> 
